_source_path() {
  local f=${1?}
  [ -f "$f" -a -r "$f" ] && . "$f"
  [ -f "$f.local" -a -r "$f.local" ] && . "${f}.local"
}

for t in $HOME/.profile.d/*; do
  if [ -z $(echo "$t" | grep -E \\.local) ]; then
    _source_path "$t"
  fi
done

for t in $HOME/.zshrc.d/*; do
  if [ -z $(echo "$t" | grep -E \\.local) ]; then
    _source_path "$t"
  fi
done

unset -f _source_path
